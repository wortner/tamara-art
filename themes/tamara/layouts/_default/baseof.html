<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">
<head>
  {{ partial "head.html" . }}
</head>
<body>
  <div class="layout">
    {{ partial "sidebar.html" . }}
    <main class="content">
      {{ block "main" . }}{{ end }}
    </main>
  </div>
  <script>
    document.querySelector('.menu-toggle').addEventListener('click', function() {
      var open = this.getAttribute('aria-expanded') === 'true';
      this.setAttribute('aria-expanded', !open);
      document.querySelector('.sidebar-nav').classList.toggle('open');
    });

    (function() {
      var triggers = document.querySelectorAll('.lightbox-trigger');
      if (!triggers.length) return;

      var overlay = document.createElement('div');
      overlay.className = 'lightbox-overlay';
      overlay.innerHTML = '<button class="lightbox-close" aria-label="Close">&times;</button><img src="" alt="">';
      document.body.appendChild(overlay);

      var overlayImg = overlay.querySelector('img');
      var closeBtn = overlay.querySelector('.lightbox-close');

      function open(src, alt) {
        overlayImg.src = src;
        overlayImg.alt = alt || '';
        overlay.style.display = 'flex';
        requestAnimationFrame(function() { overlay.classList.add('active'); });
        document.body.style.overflow = 'hidden';
      }

      function close() {
        overlay.classList.remove('active');
        setTimeout(function() { overlay.style.display = 'none'; overlayImg.src = ''; }, 300);
        document.body.style.overflow = '';
      }

      triggers.forEach(function(trigger) {
        trigger.addEventListener('click', function(e) {
          e.preventDefault();
          open(this.href, this.querySelector('img').alt);
        });
      });

      closeBtn.addEventListener('click', close);
      overlay.addEventListener('click', close);
      document.addEventListener('keydown', function(e) { if (e.key === 'Escape') close(); });
    })();
  </script>
</body>
</html>
